<!doctype html>

<html>
<title>Olivia Gajadhar</title>

<style>
.projectblocks{
    display: inline-block;
}
</style>

<script src="scripts/jquery.js"></script>
<script src="scripts/dothtml.js"></script>
<script src="scripts/dotcss.js"></script>
<script src="scripts/sequencr.js"></script>
<body></body>
<script>

jQuery.fx.interval = 83;

var gridModeEnabled = false;
var changingGridMode = false;
function gridMode(){
    if(changingGridMode) return;
    changingGridMode = true;
    $("#goleft").hide();
    $("#goright").hide();
    $("#project-scroller").animate({padding: "10%"});
    $("#project-number-" + currentFrame).animate({width: "20%"});
    dotcss("body").backgroundColor.animate("#000000");
    setTimeout(function(){
        $("#project-scroller").css("overflowY", "scroll");
        $(".projectblocks").css("width", "20%");
        $(".projectblocks").css("height", "200px;");
        $(".projectblocks").css("zoom", "10%");
        $(".projectblocks").show(400, function(){
            $("#overlay-stopper").hide();
            $('html, body').animate({
                scrollTop: $("#project-number-" + currentFrame).offset().top
            });
            gridModeEnabled = true;
            changingGridMode = false;
        });
    }, 400);
}

function presentationMode(){
    if(changingGridMode) return;
    changingGridMode = true;
    $("#project-number-" + currentFrame).animate({width: "100%"});
    $("#project-scroller").animate({padding: "0%"});
    $("#overlay-stopper").show();
    $("#project-scroller").css("overflowY", "hidden");
    $("#project-scroller").children().not("#project-number-" + currentFrame).hide(400, function(){
        $(".projectblocks").css("width", "100%");
        $(".projectblocks").css("height", "100%");
        $(".projectblocks").css("zoom", "100%");
        gridModeEnabled = false;
        changingGridMode = false;
        $("#goleft").show();
        $("#goright").show();
        scrollToCurrentProject();
    });
}

dot.createWidget("imgslide", function(file){
    return dot.div().style(dotcss.widthP(100).heightP(100).backgroundImage("userimages/" + file).backgroundRepeat("no-repeat").backgroundSize("contain").backgroundPosition("center center"));
});

var currentFrame = 0;
var frameCount = 0;

var allProjects = [];

var buildProject = function(title, fullDescription, tags, projectMarkup, backgroundColor, activateFunction, deactivateFunction){
    var thisFrameNumber = frameCount;
    allProjects.push({
        main: dot.div(
            dot.div(
                dot.div(projectMarkup).style(dotcss.display("table-cell").textAlign("center").verticalAlign("middle").margin("auto"))
            ).style(dotcss.widthP(100).heightP(100).display("table").verticalAlign("top"))
        ).class("projectblocks").id("project-number-" + frameCount).style(dotcss.widthP(100).heightP(100).display("none").verticalAlign("top")).onclick(function(){
            currentFrame = thisFrameNumber;
            presentationMode();
        }),
        title: title,
        description: fullDescription,
        tags: tags,
        backgroundColor: backgroundColor,
        activateFunction: activateFunction,
        deactivateFunction: deactivateFunction
    });
    frameCount++;
};


//var currentlyScrolling = false;
//var triedToScroll = false;
var scrollToCurrentProject = function(){

    $("#project-scroller").children().not("#project-number-" + currentFrame).hide(400);
    $("#project-number-" + currentFrame).show(400);

    dotcss("body").backgroundColor.animate(allProjects[currentFrame].backgroundColor || "#000000");

    if(allProjects[currentFrame].activateFunction) allProjects[currentFrame].activateFunction();
}

</script>
<script src="userscript.js"></script>
<script>

dotcss("body").backgroundColor("black").overflow("hidden");
dot("body")
.div(
    dot.each(allProjects, function(p){
        return p.main;
    })
).id("project-scroller").style(dotcss.position("absolute").top(0).bottom(0).left(0).right(0).overflow("hidden"))

//Gui overlay div.
.div().id("overlay-stopper").style(dotcss.position("fixed").top(0).bottom(0).left(0).right(0))

//.div().style(dotcss.position("absolute").topP(0).heightP(20).leftP(20).rightP(20).cursor("pointer"))
.div().onclick(function(){
    if(allProjects[currentFrame].deactivateFunction) allProjects[currentFrame].deactivateFunction();
    currentFrame--;
    if(currentFrame < 0) currentFrame = 0;
    scrollToCurrentProject();
}).id("goleft").style(dotcss.position("fixed").top(200).bottomP(0).leftP(0).widthP(20).cursor("pointer"))
.div().onclick(function(){
    if(allProjects[currentFrame].deactivateFunction) allProjects[currentFrame].deactivateFunction();
    currentFrame++;
    if(currentFrame >= frameCount) currentFrame = frameCount - 1;
    scrollToCurrentProject();
}).id("goright").style(dotcss.position("fixed").topP(0).bottomP(0).rightP(0).widthP(20).cursor("pointer"))
/*.div().onclick(function(){ //This feature doesn't work as well as I'd like.
    if(gridModeEnabled) presentationMode();
    else gridMode();
}).style(dotcss.position("fixed").topP(0).height(200).leftP(0).width(200).backgroundColor(0,255,0, 0.2).cursor("pointer"))*/


//Minima logo stuff.
var bottlewords = [];
var minimaAnimationOn = false;
function animationTick() {
    for (var n, i, t = 0; t < bottlewords.length; t++)
        if (n = bottlewords[t], n.animate({
                top: "+=" + n.data("ys"),
                left: "+=" + n.data("xs"),
                opacity: n.data("life") / 10
            }, 200), n.data("ys", n.data("ys") - -2), i = n.data("life"), n.data("life", i - 1), i == 0) {
            n.remove();
            bottlewords.splice(t, 1);
            t--;
            continue
        }
    minimaAnimationOn && Math.random() > .2 && createNewBottleWord();
    setTimeout(animationTick, 200);
}

function createNewBottleWord() {
    var n = $("<p><\/p>").text("m");
    n.css("position", "absolute");
    n.css("top", "42px");
    n.css("left", "236px");
    n.css("color", "white");
    n.css("font-size", "15px");
    n.data("xs", 1 + (Math.random() * 1.5 - .5) * 10);
    n.data("ys", -1 - Math.random() * 10);
    n.data("life", 20);
    n.css("opacity", "0");
    $("#minimalogoimg").append(n);
    bottlewords.push(n)
}

function AnimateRotate(selector, startAngle, endAngle, duration, callback) {
    // caching the object for performance reasons
    var $elem = $(selector);

    // we use a pseudo object for the animation
    // (starts from `0` to `angle`), you can name it as you want
    $({deg: startAngle}).animate({deg: endAngle}, {
        duration: duration || 1000,
        step: function(now) {
            // in the step-callback (that is fired each step of the animation),
            // you can use the `now` paramter which contains the current
            // animation-position (`0` up to `angle`)
            $elem.css({
                transform: 'rotate(' + now + 'deg)'
            });
        },
        complete: callback
    });
}



$(function() {
    animationTick();
    scrollToCurrentProject();
});
/*$(window).resize(function() {
    //handlemenuresize()
    scrollToCurrentProject();
});*/
//$(window).scroll(function() {
    //var n = $(window).scrollTop();
    //n > 5 ? ($("#headerslogan").hide(100), $("#headertitle").css("line-height", "30px"), $("#headertitle").css("font-size", "25px")) : n == 0 && ($("#headerslogan").show(100), $("#headertitle").css("line-height", "50px"), $("#headertitle").css("font-size", "40px"))
//})


</script>
</html>